<div *ngIf="mutex.lock" class="spinner-border mt-3" role="status">
  <span class="sr-only"></span>
  <span>Loading...</span>
</div>

<div *ngIf="!mutex.lock" class="mt-3">
  <div class="row">
    <div class="col-md-6">
      <form>
        <div class="form-group row">
          <label for="mhwSearchText" class="col-md-2 col-form-label">Search</label>
          <div class="input-group col-md-10">
            <input
              type="text"
              id="mhwSearchText"
              class="form-control"
              placeholder="search something"
              (keyup)="onSearchKey($event.target.value)"
            />
            <div class="input-group-append">
              <input type="button" class="btn btn-secondary" value="X" (click)="onSearchKey('')" />
            </div>
          </div>
        </div>
        <div class="form-group row">
          <label for="mhwTypes" class="col-md-2 col-form-label">Type</label>
          <div class="col-md-10">
            <select id="mhwTypes" class="form-control" (change)="selectType($event.target.value)">
              <option value="*">All</option>
              <option *ngFor="let type of types" [value]="type">{{ type }}</option>
            </select>
          </div>
        </div>
      </form>
    </div>
    <div class="col-md-6"></div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div *ngIf="displayedItems">
        <app-pagination
          [items]="displayedItems"
          [perPage]="20"
          (displayedItemsChange)="paginatedItems = $event"
        ></app-pagination>
        <table class="table table-hover table-sm">
          <thead class="thead-light">
            <tr>
              <th scope="col">id</th>
              <th scope="col">Name</th>
              <th scope="col">Type</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of paginatedItems" (click)="selectItem(item)">
              <th scope="row">{{ item.base.id }}</th>
              <td>{{ item.base.name }}</td>
              <td>{{ item.type }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="col-md-6">
      <div *ngIf="viewed">
        <h3>{{ viewed.base.name }} ({{ viewed.type }})</h3>
        <span *ngIf="viewed.base.type">({{ viewed.base.type  }})</span>
        <div
          *ngIf="
            [oTypes.WEAPON, oTypes.CHARM, oTypes.ARMOR].includes(viewed.type);
            else mhwItemJson
          "
        >
          <!-- <div *ngIf="types.includes(viewed.type); else mhwItemJson"> -->
          <div *ngIf="viewed.type === oTypes.ARMOR">
            ARMOR {{ viewed | json }}
            <button type="button" class="btn btn-primary" (click)="equip(viewed)">
              Equip
            </button>
          </div>
          <div *ngIf="viewed.type === oTypes.CHARM">
            <button type="button" class="btn btn-primary" (click)="equip(viewed)">
              Equip
            </button>
          </div>
          <div *ngIf="viewed.type === oTypes.WEAPON">
            <button type="button" class="btn btn-primary" (click)="equip(viewed)">
              Equip
            </button>
          </div>
        </div>
        <ng-template #mhwItemJson>{{ viewed | json }}</ng-template>
      </div>
    </div>
  </div>
</div>
